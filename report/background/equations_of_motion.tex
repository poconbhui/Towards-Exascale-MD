%
% Equations of Motion
%
\subsection{Equations of Motion}

The Lagrangian for a system of $N$ interacting bodies can be written
\begin{equation}
    L =
        \sum_{i=1}^N \frac{1}{2} m_i \vec{v}_i^2
        + \sum_{i=1}^N \sum_{\substack{j=i\\ i\ne{} j}}^N V(|\vec{x}_i - \vec{x}_j|)
\end  {equation}
where $L$ is the Lagrangian,
$N$ is the number of bodies,
$m_i$ is the mass of body $i$,
$v_i$ is the velocity of body $i$,
$x_i$ is toe position of body $i$,
and $V(|x_i - x_j|)$ is the interaction potential between two bodies.
%
This formula assumes a scalar potential and that the potential is
solely a function of distance.
%
This may be easily extended include terms involving charges, but is
ignored here.
%
We may then derive the force term for each particle
\begin{equation}
    m_i\vec{a}_i =
        - \sum_{\substack{j=1 \\ i\ne{}j}}^N
            \vec{\nabla{}}{V(|\vec{x_i} - \vec{x_j}|)}
\end  {equation}

Using the Velocity Verlet integration scheme with a time step $h$,
we have the discretized of the equations of motion
\begin{align}
    \vec{v}_i(t + \tfrac{1}{2}h) &=
        \vec{v}_i(t) + \tfrac{1}{2} \vec{a}_i(t)h
    \\
    \vec{x}_i(t + \tfrac{1}{2}h) &=
        \vec{x}_i(t) + \vec{v}_i(t + \tfrac{1}{2}h)h
    \\
    \vec{a}_i(t + h) &=
        \sum_{\substack{j=1 \\ j\ne{}i}}^N
            \vec{\nabla{}} V(|\vec{x}_i(t + h) - \vec{x}_j(t + h)|)
    \\
    \vec{v}_i(t + h) &=
        \vec{v}_i(t + \tfrac{1}{2}h) + \tfrac{1}{2}\vec{a}_i(t + h)h
\end  {align}
where $t$ is the time,
$h$ is the step size,
$v_i(t)$ is the velocity of body $i$ at time $t$,
$a_i(t)$ is the acceleration of body $i$ at time $t$,
$x_i(t)$ is the position of body $i$ at time $t$ and
$V$ and $N$ are as described above.
It is here we see the final emergence of our $\bigO{N^2}$ term,
as an $\bigO{N}$ calculation must be done for all $N$ particles of the system.

